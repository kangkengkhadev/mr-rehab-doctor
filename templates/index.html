{% extends 'template.html' %}
<!--  -->
{%block title%}Doctorpage{%endblock%}
<!--  -->
{%block content%}
<nav class="navbar navbar-expand-lg navbar-light bg-light px-4 py-2 ">
    <div class="container-fluid">
        <a class="navbar-brand" href="/doctorpage/">
            <h2>คุณหมอ {{request.session.name}} {{request.session.lastname}}</h2>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            </ul>
            <a href="/addpatientdata/?uid={{doctor_info.uid}}" class="btn btn-primary mx-2">เพิ่มข้อมูลผู้ป่วย</a>
            <a class="btn btn-danger mx-2" href="/deld/">ออกจากระบบ</a>
        </div>
    </div>
</nav>
<div class="w-100 px-5">
    <h2 class="text-center my-5 mb-3">รายชื่อผู้ป่วย</h2>
    <div class="d-flex justify-content-center my-5 mt-4">
        <form action="/doctorpage" method="get" class="form-inline d-flex justify-content-between">
            <input name="search" style="width:420px" class="form-control mr-sm-2" type="search" placeholder="ค้นหาจากชื่อ รหัสการรักษา หรือ รหัสประจำตัวผู้ป่วย " aria-label="Search">
            <input class="btn btn-primary my-2 my-sm-0 ms-1" type="submit" value="ค้นหา"/>
        </form>
    </div>
    {%if request.GET.search%}
    <div class="row row-cols-1 row-cols-md-4 g-4">
        {%for mem in data%}
        <!--  -->
        {% csrf_token %}
        <!--  -->
        {%if mem.status == 'active'%}
        {% if request.GET.search in mem.name or request.GET.search in mem.lastname or request.GET.search in mem.hospital_number or request.GET.search in mem.patient_id%}
        <a href="/patientinfo/?pid={{mem.patient_id}}" style="text-decoration: none;color:black;">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title" style="font-size:18px">ชื่อ-นามสกุล: {{mem.name}} {{mem.lastname}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสประจำตัวคนไข้: {{mem.hospital_number}}</h5>
                    <h5 class="card-title" style="font-size:18px">โรค: {{mem.dicease}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสการรักษา: {{mem.patient_id}}</h5>
                    <h5 class="card-title" style="font-size:18px">สถานะ: ระหว่างการทำกายภาพบำบัด</h5>
                    <h5 class="card-title" style="font-size:18px"></h5>
                </div>
            </div>
        </a>
        {%endif%}
        {%elif mem.status != 'active'%}
        {% if request.GET.search in mem.name or request.GET.search in mem.lastname or request.GET.search in mem.hospital_number or request.GET.search in mem.patient_id%}
        <a href="/doctorpage/" class="text-secondary" style="text-decoration: none;color:black;">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title" style="font-size:18px">ชื่อ-นามสกุล: {{mem.name}} {{mem.lastname}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสประจำตัวคนไข้: {{mem.hospital_number}}</h5>
                    <h5 class="card-title" style="font-size:18px">โรค: {{mem.dicease}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสการรักษา: {{mem.patient_id}}</h5>
                    <h5 class="card-title" style="font-size:18px">สถานะ: รอการดำเนินการ</h5>
                    <h5 class="card-title" style="font-size:18px"></h5>
                </div>
            </div>
        </a>
        {%endif%}
        {%endif%}
        <!--  -->
        {%endfor%}
    </div>
    {%else%}
    <div class="row row-cols-1 row-cols-md-4 g-4">
        {%for mem in data%}
        <!--  -->
        {% csrf_token %}
        <!--  -->
        {%if mem.status == 'active' %}
        <a href="/patientinfo/?pid={{mem.patient_id}}" style="text-decoration: none;color:black;">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title" style="font-size:18px">ชื่อ-นามสกุล: {{mem.name}} {{mem.lastname}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสประจำตัวคนไข้: {{mem.hospital_number}}</h5>
                    <h5 class="card-title" style="font-size:18px">โรค: {{mem.dicease}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสการรักษา: {{mem.patient_id}}</h5>
                    <h5 class="card-title" style="font-size:18px">สถานะ: ระหว่างการทำกายภาพบำบัด</h5>
                    <h5 class="card-title" style="font-size:18px"></h5>
                </div>
            </div>
        </a>
        {%else%}
        <a href="/doctorpage/" class="text-secondary" style="text-decoration: none;color:black;">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title" style="font-size:18px">ชื่อ-นามสกุล: {{mem.name}} {{mem.lastname}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสประจำตัวคนไข้: {{mem.hospital_number}}</h5>
                    <h5 class="card-title" style="font-size:18px">โรค: {{mem.dicease}}</h5>
                    <h5 class="card-title" style="font-size:18px">รหัสการรักษา: {{mem.patient_id}}</h5>
                    <h5 class="card-title" style="font-size:18px">สถานะ: รอการดำเนินการ</h5>
                    <h5 class="card-title" style="font-size:18px"></h5>
                </div>
            </div>
        </a>
        {%endif%}
        <!--  -->
        {%endfor%}
    </div>
    {%endif%}
    
</div>


<!--  -->
{%endblock%}